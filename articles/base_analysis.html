<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to BoeckLabRtools • BoeckLabRtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to BoeckLabRtools">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BoeckLabRtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4.0000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/base_analysis.html">Introduction</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/base_analysis.html">Analyzing Kill Curves</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/phisanti/BoeckLabRtools"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to BoeckLabRtools</h1>
            
      

      <div class="d-none name"><code>base_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>The BoeckLabRtools package provides utilities for analyzing data from
experiments in the Boeck Lab. This vignette demonstrates a common
workflow: analyzing ASCT (Automated Single-Cell Tracking) killcurves to
determine antimicrobial efficacy.</p>
<p>ASCT killcurves track cell death over time by monitoring the uptake
of propidium iodide (PI), a fluorescent dye that penetrates dead cells.
The resulting data allows us to calculate the area under the curve (AUC)
as a measure of antimicrobial effectiveness.</p>
</div>
<div class="section level2">
<h2 id="example-analysis-of-asct-killcurves-generated-with-our-pipelines">Example analysis of ASCT killcurves generated with our
pipelines<a class="anchor" aria-label="anchor" href="#example-analysis-of-asct-killcurves-generated-with-our-pipelines"></a>
</h2>
<p>The goal of this exercise is to show how to generate kill curves and
calculate the AUC from the raw output of the ASCT python pipeline. For
this exercise, we will use the example data ported with the package.
This data is a subset of the data generated by Mrs Sara Topra, a former
master student in our lab. The first step is to load the basic libraries
and the data itself</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://phisanti.github.io/BoeckLabRtools/">BoeckLabRtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">BoeckLabRtools</span><span class="fu">::</span><span class="va">killcurves</span><span class="op">)</span></span></code></pre></div>
<p>The data is a data.table with the following columns:
<code>colnames(d)</code> - <strong>file</strong>: Character vector
representing the file name - <strong>frame</strong>: Integer vector
representing the frame number - <strong>channel</strong>: Integer vector
representing the channel number - <strong>date_time</strong>: POSIXct
vector with the date and time of the frame - <strong>timestep</strong>:
Numeric vector representing the time step from the start of the
experiment - <strong>object_class</strong>: Character vector
representing the object class (single-cell, noise, off-focus, or clump)
- <strong>total_count</strong>: Integer vector with the total count of
objects for the given class - <strong>pi_class_neg</strong>: Integer
vector with the PI negative class count - <strong>pi_class_pos</strong>:
Integer vector the PI positive class count -
<strong>area_pineg</strong>: Numeric vector of the total area of PI
negative objects - <strong>area_pipos</strong>: Integer vector of the
total area of PI positive objects</p>
<p>Next, we will try to extract the well and field information that is
stored in the filenaming pattern. For that, we use the
<code>tstrsplit</code> function from the data.table package. The
<code>tstrsplit</code> function is a powerful function that allows us to
split strings based on a regular expression pattern. In this case, we
will split the file name based on the underscore character
(<code>_</code>). The <code>keep</code> argument is used to keep the
second and fourth elements of the split. The result is stored in the
<code>well</code> and <code>field</code> columns.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"well"</span>, <span class="st">"field"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/tstrsplit.html" class="external-link">tstrsplit</a></span><span class="op">(</span><span class="va">file</span>, <span class="st">"_"</span>, keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/tstrsplit.html" class="external-link">tstrsplit</a></span><span class="op">(</span><span class="va">well</span>, <span class="st">"(?&lt;=\\D)(?=\\d)"</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="va">col</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="filling-missing-classes">Filling Missing Classes<a class="anchor" aria-label="anchor" href="#filling-missing-classes"></a>
</h3>
<p>The next step is to fill the missing classes. This is due to the fact
that the segmentation and classification algorithm sometimes does not
find object of some class in a particular frame. This is normal, but not
having all the objects for every frame can cause problems downstream.
The <code>fill_missing_classes</code> function is a helper function that
fills the counts of missing classes with 0 values. The
<code>key_cols</code> argument is a character vector with the columns
that will be used to group the data. The <code>fill_col</code> argument
is the column that will be filled. The <code>cols_0count</code> argument
is a character vector with the columns that will be filled with zeros.
The <code>required_values</code> argument is a character vector with all
the unique values that will be used to fill the missing classes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fill_missing_classes.html">fill_missing_classes</a></span><span class="op">(</span></span>
<span>  dt <span class="op">=</span> <span class="va">d</span>,</span>
<span>  key_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"file"</span>, <span class="st">"frame"</span>, <span class="st">"row"</span>, <span class="st">"col"</span>, <span class="st">"well"</span>, <span class="st">"field"</span><span class="op">)</span>,</span>
<span>  fill_col <span class="op">=</span> <span class="st">"object_class"</span>,</span>
<span>  cols_0count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"total_count"</span>, <span class="st">"pi_class_neg"</span>, <span class="st">"pi_class_pos"</span>, <span class="st">"area_pineg"</span>, <span class="st">"area_pipos"</span><span class="op">)</span>,</span>
<span>  required_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">object_class</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now, given the fact that we have inputed some rows, we also need to
fill the data_time and timestep (and maybe other columns), but instead
of filling with 0, we fill with the unique time for that frame and file.
We take the 2 value because the first value is the NA itself.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fill_cols_uniq_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date_time"</span>, <span class="st">"timestep"</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="op">(</span><span class="va">fill_cols_uniq_val</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  .SDcols <span class="op">=</span> <span class="va">fill_cols_uniq_val</span>, </span>
<span>  by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">file</span>, <span class="va">frame</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-treatment-information">Adding Treatment Information<a class="anchor" aria-label="anchor" href="#adding-treatment-information"></a>
</h3>
The data is now ready to include the drug info or species info from our
plate schema. If your plate schema looks as follows:
<table class="table table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<strong>Plate Schema with Treatment Information</strong>
</caption>
<thead><tr>
<th style="text-align:center;">
row
</th>
<th style="text-align:center;">
3
</th>
<th style="text-align:center;">
4
</th>
<th style="text-align:center;">
5
</th>
<th style="text-align:center;">
6
</th>
<th style="text-align:center;">
7
</th>
<th style="text-align:center;">
8
</th>
<th style="text-align:center;">
9
</th>
<th style="text-align:center;">
10
</th>
<th style="text-align:center;">
11
</th>
<th style="text-align:center;">
12
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
C
</td>
<td style="text-align:center;">
IPM
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
MXF
</td>
<td style="text-align:center;">
MXF
</td>
</tr>
<tr>
<td style="text-align:center;">
D
</td>
<td style="text-align:center;">
IPM
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
IPM
</td>
<td style="text-align:center;">
CLR
</td>
<td style="text-align:center;">
CLR
</td>
</tr>
<tr>
<td style="text-align:center;">
E
</td>
<td style="text-align:center;">
IPM
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
IPM
</td>
<td style="text-align:center;">
CLR
</td>
<td style="text-align:center;">
TGC
</td>
</tr>
<tr>
<td style="text-align:center;">
F
</td>
<td style="text-align:center;">
IPM
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
IPM
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
AMK
</td>
</tr>
<tr>
<td style="text-align:center;">
G
</td>
<td style="text-align:center;">
MXF
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
TGC
</td>
</tr>
<tr>
<td style="text-align:center;">
H
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
TGC
</td>
<td style="text-align:center;">
IPM
</td>
<td style="text-align:center;">
AMK
</td>
<td style="text-align:center;">
AMK
</td>
</tr>
</tbody>
</table>
<div style="font-size: smaller; font-style: italic; margin-top: 10px;">
Treatment abbreviations: IPM - Imipenem, TGC - Tigecycline, AMK -
Amikacin, MXF - Moxifloxacin, CLR - Clarithromycin
</div>
<p>Then, you can use the <code>add_well_info</code> function to include
the drug info in the data table. In this example, we use the already
example plate schema, but you can add the data directly from the
file</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_well_info.html">add_well_info</a></span><span class="op">(</span><span class="va">d</span>, </span>
<span>                   <span class="va">plate_schema</span>, <span class="co"># In your case plate schema can be a path to the file</span></span>
<span>                   info_name <span class="op">=</span> <span class="st">"treatment"</span>,</span>
<span>                   plate_format <span class="op">=</span> <span class="st">"plate_view"</span></span>
<span>                   <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculating-live-cell-fraction">Calculating Live Cell Fraction<a class="anchor" aria-label="anchor" href="#calculating-live-cell-fraction"></a>
</h3>
<p>At this point, we can proceed to calculate the relative live
fraction. For that, we will focus on the single-cell objects and then
divide the counts of PI cells by the total number of single-cells (PI +
no PI single cell). This, give us the fraction of PI positive cells
(dead cells). The live fraction is then calculated as 1 - PI
fraction.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">d</span><span class="op">[</span>, <span class="va">valid_cell</span> <span class="op">:=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">object_class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'single-cell'</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d_sc</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span><span class="va">object_class</span> <span class="op">==</span> <span class="st">"single-cell"</span><span class="op">]</span></span>
<span><span class="va">d_sc</span><span class="op">[</span>, <span class="va">pi_frac</span> <span class="op">:=</span> <span class="va">pi_class_pos</span><span class="op">/</span><span class="va">total_count</span>, </span>
<span>        by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">file</span>, <span class="va">valid_cell</span>, <span class="va">frame</span>, <span class="va">object_class</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d_sc</span><span class="op">[</span>, <span class="va">live_frac</span> <span class="op">:=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">pi_frac</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpolating-time-points">Interpolating Time Points<a class="anchor" aria-label="anchor" href="#interpolating-time-points"></a>
</h3>
<p>Finally, we need to get the same time point for all our frames. For
large experiments, it is very common to have a shift ranging from
minutes to hours from the wells that are scanned early in the loop to
the later wells. To correct this, we use the
<code>interpolate_variable</code> function. This function interpolates
the variable of interest (in this case, the live fraction) for the time
points of interest calculating the linear mid-point between two given
points. The <code>timepoints</code> argument is the time points that we
want to interpolate. We can set plain regular intervals, or a vector of
timepoints of interest (0, 6, 12, 24…). The <code>fill_extremes</code>
argument is used to fill the first and last time points with the first
and last values of the variable of interest. The
<code>return_time</code> argument is used to return the time points of
interest, if we want to interpolate more than one variable, we can set
this to <code>FALSE</code> for subsequent calls. The result is stored in
the <code>interpol_time</code> and <code>interpol_live_frac</code>
columns. Note the use of <code>by =</code> in order to denote that we
interpolate each live fraction by each file. After that, it is also
important to consider that we use the <code>enforce_decrease</code> in
order to make sure that the live fraction is always decreasing.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">d_sc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"interpol_time"</span>, <span class="st">"interpol_live_frac"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="../reference/interpolate_variable.html">interpolate_variable</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">timestep</span>, </span>
<span>                                                                     values <span class="op">=</span> <span class="va">live_frac</span>, </span>
<span>                                                                     timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span>, </span>
<span>                                                                     fill_extremes <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                                                     return_time <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>          by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">d_sc</span><span class="op">[</span>, <span class="va">interpol_live_frac</span> <span class="op">:=</span> <span class="fu"><a href="../reference/enforce_decrease.html">enforce_decrease</a></span><span class="op">(</span><span class="va">interpol_live_frac</span><span class="op">)</span>, </span>
<span>  by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>At this point, we have our kill curves! We only need to plot them.
Depending on the size of your dataset, you can do a simple grouped plot
by panel or if you have too many conditions, you might need to filter
your data.</p>
</div>
<div class="section level3">
<h3 id="visualizing-the-kill-curves">Visualizing the Kill Curves<a class="anchor" aria-label="anchor" href="#visualizing-the-kill-curves"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="va">d_sc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">timestep</span>, y <span class="op">=</span><span class="va">live_frac</span>, group <span class="op">=</span> <span class="va">file</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">well</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">treatment</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_BoeckLab.html">theme_BoeckLab</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="base_analysis_files/figure-html/plot_killcurves-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="calculating-area-under-the-curve-auc">Calculating Area Under the Curve (AUC)<a class="anchor" aria-label="anchor" href="#calculating-area-under-the-curve-auc"></a>
</h3>
<p>For further analysis, we can compress the data to a single value. For
that, we can calculate the area under the curve (AUC) for each well. The
<code>calculate_AUC</code> function calculates the AUC for each well.
The <code>key_cols</code> argument is a character vector with the
columns that will be used to group the data. The <code>value_col</code>
argument is the column that will be used to calculate the AUC. The
<code>time_col</code> argument is the column that will be used as the
x-axis. The result is stored in the <code>AUC</code> column. In this
case, we group by as many variables as we need using the
<code>by =</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">auc_data</span> <span class="op">&lt;-</span> <span class="va">d_sc</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>auc <span class="op">=</span> <span class="fu"><a href="../reference/calc_auc.html">calc_auc</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">interpol_time</span>, y <span class="op">=</span> <span class="va">interpol_live_frac</span><span class="op">)</span><span class="op">)</span>, </span>
<span>              by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">file</span>, <span class="va">well</span>, <span class="va">field</span>, <span class="va">row</span>, <span class="va">col</span>, <span class="va">treatment</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarizing-results-by-treatment">Summarizing Results by Treatment<a class="anchor" aria-label="anchor" href="#summarizing-results-by-treatment"></a>
</h3>
<p>As last example figure, we can make a bar plot with error bars for
our AUC for each treatment:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">auc_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>auc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">auc</span><span class="op">)</span>, sd_auc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">auc</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">auc</span>, fill <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">auc</span> <span class="op">-</span> <span class="va">sd_auc</span>, ymax <span class="op">=</span> <span class="va">auc</span> <span class="op">+</span> <span class="va">sd_auc</span><span class="op">)</span>, </span>
<span>                position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_BoeckLab.html">theme_BoeckLab</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="base_analysis_files/figure-html/summarize_by_treatment-1.png" width="768"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
